<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Tensor Network Decoder · TensorQEC.jl</title><meta name="title" content="Tensor Network Decoder · TensorQEC.jl"/><meta property="og:title" content="Tensor Network Decoder · TensorQEC.jl"/><meta property="twitter:title" content="Tensor Network Decoder · TensorQEC.jl"/><meta name="description" content="Documentation for TensorQEC.jl."/><meta property="og:description" content="Documentation for TensorQEC.jl."/><meta property="twitter:description" content="Documentation for TensorQEC.jl."/><meta property="og:url" content="https://nzy1997.github.io/TensorQEC.jl/tndecoder/"/><meta property="twitter:url" content="https://nzy1997.github.io/TensorQEC.jl/tndecoder/"/><link rel="canonical" href="https://nzy1997.github.io/TensorQEC.jl/tndecoder/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">TensorQEC.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><span class="tocitem">Topics</span><ul><li><a class="tocitem" href="../clifford/">Pauli Basis and Clifford group</a></li><li><a class="tocitem" href="../generated/codes/">QEC Codes</a></li><li><a class="tocitem" href="../generated/inference/">Inference with Tensor Network</a></li><li><a class="tocitem" href="../generated/coherent/">Coherent Error Simulation</a></li><li><a class="tocitem" href="../generated/simulation/">Measurement-Free QEC</a></li><li><input class="collapse-toggle" id="menuitem-2-6" type="checkbox" checked/><label class="tocitem" for="menuitem-2-6"><span class="docs-label">Decoders</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../generated/error_model/">Error Model and Syndrome Extraction</a></li><li><a class="tocitem" href="../generated/decoder/">Decoder Interface</a></li><li><a class="tocitem" href="../generated/ipdecoder/">Mixed-Integer Programming Decoder</a></li><li class="is-active"><a class="tocitem" href>Tensor Network Decoder</a><ul class="internal"><li><a class="tocitem" href="#Marginal-Maximum-A-Posteriori-(MMAP)-Decoder"><span>Marginal Maximum A Posteriori (MMAP) Decoder</span></a></li><li><a class="tocitem" href="#Maximum-A-Posteriori-(MAP)-Decoder"><span>Maximum A Posteriori (MAP) Decoder</span></a></li></ul></li></ul></li><li><a class="tocitem" href="../performancetips/">Performance Tips</a></li></ul></li><li><a class="tocitem" href="../man/">Manual</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Topics</a></li><li><a class="is-disabled">Decoders</a></li><li class="is-active"><a href>Tensor Network Decoder</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Tensor Network Decoder</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/nzy1997/TensorQEC.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/nzy1997/TensorQEC.jl/blob/main/docs/src/tndecoder.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Tensor-Network-Decoder"><a class="docs-heading-anchor" href="#Tensor-Network-Decoder">Tensor Network Decoder</a><a id="Tensor-Network-Decoder-1"></a><a class="docs-heading-anchor-permalink" href="#Tensor-Network-Decoder" title="Permalink"></a></h1><p>In this section, we introduce the tensor network decoder.</p><h2 id="Marginal-Maximum-A-Posteriori-(MMAP)-Decoder"><a class="docs-heading-anchor" href="#Marginal-Maximum-A-Posteriori-(MMAP)-Decoder">Marginal Maximum A Posteriori (MMAP) Decoder</a><a id="Marginal-Maximum-A-Posteriori-(MMAP)-Decoder-1"></a><a class="docs-heading-anchor-permalink" href="#Marginal-Maximum-A-Posteriori-(MMAP)-Decoder" title="Permalink"></a></h2><p><a href="../man/#TensorQEC.TNMMAP"><code>TNMMAP</code></a> is a tensor network based marginal maximum a posteriori (MMAP) decoder, which finds the most probable logical sector after marginalizing out the error pattern on qubits. We can generate a <code>TNMMAP</code> decoder by <code>TNMMAP()</code>.</p><pre><code class="language-julia hljs">using TensorQEC, TensorQEC.OMEinsum
decoder = TNMMAP(TreeSA())</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">TNMMAP</code></pre><p>Here <code>TreeSA()</code> is the default optimizer for optimizing the tensor network contraction order.</p><p>Now we use the Steane code as an example. <img src="../images/steane.svg" alt/></p><pre><code class="language-julia hljs">steane = SteaneCode()
tanner = CSSTannerGraph(steane)
st = stabilizers(steane)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">6-element Vector{PauliString{7}}:
 XIXIXIX
 IXXIIXX
 IIIXXXX
 ZIZIZIZ
 IZZIIZZ
 IIIZZZZ</code></pre><p>Given a depolarizing error model, we can randomly generate an error pattern</p><pre><code class="language-julia hljs">error_model = iid_error(0.05,0.05,0.05, 7)
using Random
Random.seed!(1)
error_pattern = random_error_qubits(error_model)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">XIIIIII
</code></pre><p>Now we can measure the syndrome:</p><pre><code class="language-julia hljs">syndrome = syndrome_extraction(error_pattern, tanner)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">CSSSyndrome(Mod2[0₂, 0₂, 0₂], Mod2[1₂, 0₂, 0₂])</code></pre><p>To use the decoder, we need to compile it first.</p><pre><code class="language-julia hljs">compiled_decoder = compile(decoder, tanner, error_model);</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">TensorQEC.CompiledTNMMAP{OMEinsum.SlicedEinsum{Int64, OMEinsum.DynamicNestedEinsum{Int64}}, Array{Float64}}(CSSTannerGraph(SimpleTannerGraph(7, 3, [[1], [2], [1, 2], [3], [1, 3], [2, 3], [1, 2, 3]], [[1, 3, 5, 7], [2, 3, 6, 7], [4, 5, 6, 7]], Mod2[1₂ 0₂ … 0₂ 1₂; 0₂ 1₂ … 1₂ 1₂; 0₂ 0₂ … 1₂ 1₂]), SimpleTannerGraph(7, 3, [[1], [2], [1, 2], [3], [1, 3], [2, 3], [1, 2, 3]], [[1, 3, 5, 7], [2, 3, 6, 7], [4, 5, 6, 7]], Mod2[1₂ 0₂ … 0₂ 1₂; 0₂ 1₂ … 1₂ 1₂; 0₂ 0₂ … 1₂ 1₂])), Mod2[0₂ 0₂ … 1₂ 0₂], Mod2[0₂ 0₂ … 1₂ 0₂], OMEinsum.SlicedEinsum{Int64, OMEinsum.DynamicNestedEinsum{Int64}}(Int64[], 22∘12∘10∘13, 10∘12∘13∘21 -&gt; 21∘22
├─ 13∘3∘5∘22∘6, 6∘13∘5∘3∘12∘10 -&gt; 22∘12∘10∘13
│  ├─ 6∘13, 3∘5∘6∘22 -&gt; 13∘3∘5∘22∘6
│  │  ├─ 6∘13
│  │  └─ 3∘5∘6∘22
│  └─ 5∘3∘12∘14∘10∘7, 3∘10∘5∘12∘6∘7∘13∘14 -&gt; 6∘13∘5∘3∘12∘10
│     ├─ 10∘1∘5∘7∘3, 7∘1∘10∘12∘14 -&gt; 5∘3∘12∘14∘10∘7
│     │  ├─ 3∘10, 1∘3∘5∘7 -&gt; 10∘1∘5∘7∘3
│     │  │  ├─ 3∘10
│     │  │  └─ 18, 1∘3∘5∘7∘18 -&gt; 1∘3∘5∘7
│     │  │     ⋮
│     │  │     
│     │  └─ 7∘14, 1∘10∘12∘14 -&gt; 7∘1∘10∘12∘14
│     │     ├─ 7∘14
│     │     └─ 1∘8, 8∘10∘12∘14 -&gt; 1∘10∘12∘14
│     │        ⋮
│     │        
│     └─ 3∘6∘7∘10∘13∘14, 6∘7∘5∘13∘14∘12 -&gt; 3∘10∘5∘12∘6∘7∘13∘14
│        ├─ 2∘3∘6∘7, 10∘13∘14∘2 -&gt; 3∘6∘7∘10∘13∘14
│        │  ├─ 19, 2∘3∘6∘7∘19 -&gt; 2∘3∘6∘7
│        │  │  ⋮
│        │  │  
│        │  └─ 9∘10∘13∘14, 2∘9 -&gt; 10∘13∘14∘2
│        │     ⋮
│        │     
│        └─ 11∘6∘7∘12∘5, 11∘12∘13∘14 -&gt; 6∘7∘5∘13∘14∘12
│           ├─ 11∘5∘6∘7, 5∘12 -&gt; 11∘6∘7∘12∘5
│           │  ⋮
│           │  
│           └─ 11∘12∘13∘14∘17, 17 -&gt; 11∘12∘13∘14
│              ⋮
│              
└─ 10∘12∘13∘21
), Array{Float64}[[1.0 0.0; 0.0 1.0;;; 0.0 1.0; 1.0 0.0;;;; 0.0 1.0; 1.0 0.0;;; 1.0 0.0; 0.0 1.0;;;;; 0.0 1.0; 1.0 0.0;;; 1.0 0.0; 0.0 1.0;;;; 1.0 0.0; 0.0 1.0;;; 0.0 1.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 1.0; 1.0 0.0;;;; 0.0 1.0; 1.0 0.0;;; 1.0 0.0; 0.0 1.0;;;;; 0.0 1.0; 1.0 0.0;;; 1.0 0.0; 0.0 1.0;;;; 1.0 0.0; 0.0 1.0;;; 0.0 1.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 1.0; 1.0 0.0;;;; 0.0 1.0; 1.0 0.0;;; 1.0 0.0; 0.0 1.0;;;;; 0.0 1.0; 1.0 0.0;;; 1.0 0.0; 0.0 1.0;;;; 1.0 0.0; 0.0 1.0;;; 0.0 1.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 1.0; 1.0 0.0;;;; 0.0 1.0; 1.0 0.0;;; 1.0 0.0; 0.0 1.0;;;;; 0.0 1.0; 1.0 0.0;;; 1.0 0.0; 0.0 1.0;;;; 1.0 0.0; 0.0 1.0;;; 0.0 1.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 1.0; 1.0 0.0;;;; 0.0 1.0; 1.0 0.0;;; 1.0 0.0; 0.0 1.0;;;;; 0.0 1.0; 1.0 0.0;;; 1.0 0.0; 0.0 1.0;;;; 1.0 0.0; 0.0 1.0;;; 0.0 1.0; 1.0 0.0], [1.0 0.0; 0.0 1.0;;; 0.0 1.0; 1.0 0.0;;;; 0.0 1.0; 1.0 0.0;;; 1.0 0.0; 0.0 1.0;;;;; 0.0 1.0; 1.0 0.0;;; 1.0 0.0; 0.0 1.0;;;; 1.0 0.0; 0.0 1.0;;; 0.0 1.0; 1.0 0.0], [0.8499999999999999 0.05; 0.05 0.05], [0.8499999999999999 0.05; 0.05 0.05], [0.8499999999999999 0.05; 0.05 0.05], [0.8499999999999999 0.05; 0.05 0.05]  …  [0.8499999999999999 0.05; 0.05 0.05], [0.8499999999999999 0.05; 0.05 0.05], [1.0 0.0; 0.0 1.0;;; 0.0 1.0; 1.0 0.0;;;; 0.0 1.0; 1.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0 0.0; 0.0 1.0;;; 0.0 1.0; 1.0 0.0;;;; 0.0 1.0; 1.0 0.0;;; 1.0 0.0; 0.0 1.0], [1.0, 0.0], [1.0, 0.0], [1.0, 0.0], [1.0, 0.0], [1.0, 0.0], [1.0, 0.0]], [15, 16, 17, 18, 19, 20], [1.0, 0.0], [0.0, 1.0])</code></pre><p>At this time we generate the tensor network<sup class="footnote-reference"><a id="citeref-Piveteau" href="#footnote-Piveteau">[Piveteau]</a></sup> for the code and the error model, as shown in the following figure. <img src="../images/tensornetwork.svg" alt/></p><p>The squares represent tensors, and the circles represent the indices of the tensors. All indices are of dimension 2. We use 7 indices to represent <span>$X$</span> errors on qubits, and 7 indices to represent <span>$Z$</span> errors on qubits. On each qubit, the distribution of this two types of errors is correlated. The green squares represent this correlation. All purple squares represent the parity tensor, which elements are 1 if the input parity is even, and 0 otherwise. <img src="../images/label.svg" alt/></p><p>The gray circles represent the syndrome and the brown circles represent the logical operators. The marginal maximum a posteriori (MMAP) decoding problem is to find the most probable logical sector, given the syndrome and marginalize out the error pattern on qubits.</p><p>The contraction order of the tensor network is optimized by the optimizer <code>decoder.optimizer</code> and the optimal contraction order is stored in <code>compiled_decoder.optcode</code>.</p><pre><code class="language-julia hljs">contraction_complexity(compiled_decoder.optcode,uniformsize(compiled_decoder.optcode, 2))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Time complexity: 2^10.531381460516313
Space complexity: 2^8.0
Read-write complexity: 2^10.854868383260238</code></pre><p>Now we can decode the syndrome. The decoding process is to update the syndrome into the tensor network, and then contract the tensor network to get the marginal probability. According to the maximum marginal probability, we can get the most probable logical sector.</p><pre><code class="language-julia hljs">result = decode(compiled_decoder, syndrome)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Success
IXIXIIX

</code></pre><p>Also, we can use the <code>decode</code> function to decode the syndrome directly.</p><pre><code class="language-julia hljs">result = decode(compiled_decoder, syndrome)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Success
IXIXIIX

</code></pre><p>To check the decoding result, we can first check whether we get a same syndrome as the input syndrome.</p><pre><code class="language-julia hljs">syndrome == syndrome_extraction(result.error_qubits, tanner)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">true</code></pre><p>Then we can check whether there is a logical error. First we need to get the logical operators.</p><pre><code class="language-julia hljs">lx, lz = logical_operator(tanner)
check_logical_error(result.error_qubits, error_pattern, lx, lz)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">false</code></pre><p>Here <code>false</code> means no logical error, and <code>true</code> means there is a logical error.</p><h2 id="Maximum-A-Posteriori-(MAP)-Decoder"><a class="docs-heading-anchor" href="#Maximum-A-Posteriori-(MAP)-Decoder">Maximum A Posteriori (MAP) Decoder</a><a id="Maximum-A-Posteriori-(MAP)-Decoder-1"></a><a class="docs-heading-anchor-permalink" href="#Maximum-A-Posteriori-(MAP)-Decoder" title="Permalink"></a></h2><p><a href="../man/#TensorQEC.TNMAP"><code>TNMAP</code></a> is a tensor network based maximum a posteriori (MAP) decoder, which finds the most probable configuration of the error pattern. The decoding process is similar to the MMAP decoder.</p><pre><code class="language-julia hljs">compiled_decoder = compile(TNMAP(), tanner, error_model);
decode(compiled_decoder, syndrome)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Success
XIIIIII

</code></pre><section class="footnotes is-size-7"><ul><li class="footnote" id="footnote-Piveteau"><a class="tag is-link" href="#citeref-Piveteau">Piveteau</a>Piveteau, C.; Chubb, C. T.; Renes, J. M. Tensor Network Decoding Beyond 2D. PRX Quantum 2024, 5 (4), 040303. https://doi.org/10.1103/PRXQuantum.5.040303.</li></ul></section></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../generated/ipdecoder/">« Mixed-Integer Programming Decoder</a><a class="docs-footer-nextpage" href="../performancetips/">Performance Tips »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Wednesday 30 July 2025 04:47">Wednesday 30 July 2025</span>. Using Julia version 1.11.6.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
