<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Coherent Error Simulation · TensorQEC.jl</title><meta name="title" content="Coherent Error Simulation · TensorQEC.jl"/><meta property="og:title" content="Coherent Error Simulation · TensorQEC.jl"/><meta property="twitter:title" content="Coherent Error Simulation · TensorQEC.jl"/><meta name="description" content="Documentation for TensorQEC.jl."/><meta property="og:description" content="Documentation for TensorQEC.jl."/><meta property="twitter:description" content="Documentation for TensorQEC.jl."/><meta property="og:url" content="https://nzy1997.github.io/TensorQEC.jl/generated/coherent/"/><meta property="twitter:url" content="https://nzy1997.github.io/TensorQEC.jl/generated/coherent/"/><link rel="canonical" href="https://nzy1997.github.io/TensorQEC.jl/generated/coherent/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">TensorQEC.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Topics</span><ul><li><a class="tocitem" href="../codes/">QEC Codes</a></li><li><a class="tocitem" href="../clifford/">Pauli Basis and Clifford group</a></li><li><a class="tocitem" href="../inference/">Inference with Tensor Network</a></li><li><a class="tocitem" href="../table/">Inference with Truth Table</a></li><li><a class="tocitem" href="../simulation/">Measurement-Free QEC</a></li><li class="is-active"><a class="tocitem" href>Coherent Error Simulation</a><ul class="internal"><li><a class="tocitem" href="#Quantum-Circuit-Construction"><span>Quantum Circuit Construction</span></a></li><li><a class="tocitem" href="#Coherent-Error-Simulation-2"><span>Coherent Error Simulation</span></a></li></ul></li></ul></li><li><a class="tocitem" href="../../man/">Manual</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Topics</a></li><li class="is-active"><a href>Coherent Error Simulation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Coherent Error Simulation</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/nzy1997/TensorQEC.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/nzy1997/TensorQEC.jl/blob/main/examples/coherent.jl" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Coherent-Error-Simulation"><a class="docs-heading-anchor" href="#Coherent-Error-Simulation">Coherent Error Simulation</a><a id="Coherent-Error-Simulation-1"></a><a class="docs-heading-anchor-permalink" href="#Coherent-Error-Simulation" title="Permalink"></a></h1><p>Coherent error or unitary error is a type of error that can be described by a unitary matrix acting on the quantum state. For example, if we want to apply an unitary <span>$U$</span> on the state, however, we apply a unitary <span>$U&#39;$</span> instead, which differ from <span>$U$</span> slighty. The error can be described by an unitary <span>$E = U&#39;U^{\dagger}$</span> acting on the quantum state. Usually, this unitary is non-Clifford, thus it is hard to simulate with the stabilizer formalism. Here, we use tensor network to simulate a quantum circuit with coherent error.</p><h2 id="Quantum-Circuit-Construction"><a class="docs-heading-anchor" href="#Quantum-Circuit-Construction">Quantum Circuit Construction</a><a id="Quantum-Circuit-Construction-1"></a><a class="docs-heading-anchor-permalink" href="#Quantum-Circuit-Construction" title="Permalink"></a></h2><p>First, we define the stabilizers for 3-qubit repetition code.</p><pre><code class="language-julia hljs">using TensorQEC, TensorQEC.Yao
using TensorQEC.OMEinsum
st = [PauliString((1,4,4)),PauliString((4,1,4))]</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">2-element Vector{PauliString{3}}:
 IZZ
 ZIZ</code></pre><p>Then we generate the encoding circuits of the stabilizers by <a href="../../man/#TensorQEC.encode_stabilizers-Union{Tuple{AbstractArray{PauliString{N}, 1}}, Tuple{N}} where N"><code>encode_stabilizers</code></a>. <code>qc</code> is the encoding circuit, <code>data_qubits</code> are the qubits that we should put initial qubtis in, and <code>code</code> is the structure records information of the encoding circuit.</p><pre><code class="language-julia hljs">qcen, data_qubits, code = encode_stabilizers(st)
vizcircuit(qcen)</code></pre><img src='data:image/svg+xml;utf-8,<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="153" height="135" viewBox="0 0 153 135">
<path fill="none" stroke-width="1" stroke-linecap="butt" stroke-linejoin="miter" stroke="rgb(0%25, 0%25, 0%25)" stroke-opacity="1" stroke-miterlimit="10" d="M 59.398438 67.5 C 59.398438 72.140625 55.640625 75.898438 51 75.898438 C 46.359375 75.898438 42.601562 72.140625 42.601562 67.5 C 42.601562 62.859375 46.359375 59.101562 51 59.101562 C 55.640625 59.101562 59.398438 62.859375 59.398438 67.5 Z M 59.398438 67.5 "/>
<path fill="none" stroke-width="1" stroke-linecap="butt" stroke-linejoin="miter" stroke="rgb(0%25, 0%25, 0%25)" stroke-opacity="1" stroke-miterlimit="10" d="M 42.601562 67.5 L 59.398438 67.5 "/>
<path fill="none" stroke-width="1" stroke-linecap="butt" stroke-linejoin="miter" stroke="rgb(0%25, 0%25, 0%25)" stroke-opacity="1" stroke-miterlimit="10" d="M 51 59.101562 L 51 75.898438 "/>
<path fill-rule="nonzero" fill="rgb(0%25, 0%25, 0%25)" fill-opacity="1" d="M 53.398438 112.5 C 53.398438 113.824219 52.324219 114.898438 51 114.898438 C 49.675781 114.898438 48.601562 113.824219 48.601562 112.5 C 48.601562 111.175781 49.675781 110.101562 51 110.101562 C 52.324219 110.101562 53.398438 111.175781 53.398438 112.5 Z M 53.398438 112.5 "/>
<path fill="none" stroke-width="1" stroke-linecap="butt" stroke-linejoin="miter" stroke="rgb(0%25, 0%25, 0%25)" stroke-opacity="1" stroke-miterlimit="10" d="M 51 110.101562 L 51 75.898438 "/>
<path fill="none" stroke-width="1" stroke-linecap="butt" stroke-linejoin="miter" stroke="rgb(0%25, 0%25, 0%25)" stroke-opacity="1" stroke-miterlimit="10" d="M 25.5 67.5 L 42.601562 67.5 "/>
<path fill="none" stroke-width="1" stroke-linecap="butt" stroke-linejoin="miter" stroke="rgb(0%25, 0%25, 0%25)" stroke-opacity="1" stroke-miterlimit="10" d="M 59.398438 67.5 L 76.5 67.5 "/>
<path fill="none" stroke-width="1" stroke-linecap="butt" stroke-linejoin="miter" stroke="rgb(0%25, 0%25, 0%25)" stroke-opacity="1" stroke-miterlimit="10" d="M 25.5 112.5 L 48.601562 112.5 "/>
<path fill="none" stroke-width="1" stroke-linecap="butt" stroke-linejoin="miter" stroke="rgb(0%25, 0%25, 0%25)" stroke-opacity="1" stroke-miterlimit="10" d="M 53.398438 112.5 L 76.5 112.5 "/>
<path fill="none" stroke-width="1" stroke-linecap="butt" stroke-linejoin="miter" stroke="rgb(0%25, 0%25, 0%25)" stroke-opacity="1" stroke-miterlimit="10" d="M 110.398438 22.5 C 110.398438 27.140625 106.640625 30.898438 102 30.898438 C 97.359375 30.898438 93.601562 27.140625 93.601562 22.5 C 93.601562 17.859375 97.359375 14.101562 102 14.101562 C 106.640625 14.101562 110.398438 17.859375 110.398438 22.5 Z M 110.398438 22.5 "/>
<path fill="none" stroke-width="1" stroke-linecap="butt" stroke-linejoin="miter" stroke="rgb(0%25, 0%25, 0%25)" stroke-opacity="1" stroke-miterlimit="10" d="M 93.601562 22.5 L 110.398438 22.5 "/>
<path fill="none" stroke-width="1" stroke-linecap="butt" stroke-linejoin="miter" stroke="rgb(0%25, 0%25, 0%25)" stroke-opacity="1" stroke-miterlimit="10" d="M 102 14.101562 L 102 30.898438 "/>
<path fill-rule="nonzero" fill="rgb(0%25, 0%25, 0%25)" fill-opacity="1" d="M 104.398438 112.5 C 104.398438 113.824219 103.324219 114.898438 102 114.898438 C 100.675781 114.898438 99.601562 113.824219 99.601562 112.5 C 99.601562 111.175781 100.675781 110.101562 102 110.101562 C 103.324219 110.101562 104.398438 111.175781 104.398438 112.5 Z M 104.398438 112.5 "/>
<path fill="none" stroke-width="1" stroke-linecap="butt" stroke-linejoin="miter" stroke="rgb(0%25, 0%25, 0%25)" stroke-opacity="1" stroke-miterlimit="10" d="M 102 110.101562 L 102 30.898438 "/>
<path fill="none" stroke-width="1" stroke-linecap="butt" stroke-linejoin="miter" stroke="rgb(0%25, 0%25, 0%25)" stroke-opacity="1" stroke-miterlimit="10" d="M 25.5 22.5 L 93.601562 22.5 "/>
<path fill="none" stroke-width="1" stroke-linecap="butt" stroke-linejoin="miter" stroke="rgb(0%25, 0%25, 0%25)" stroke-opacity="1" stroke-miterlimit="10" d="M 110.398438 22.5 L 127.5 22.5 "/>
<path fill="none" stroke-width="1" stroke-linecap="butt" stroke-linejoin="miter" stroke="rgb(0%25, 0%25, 0%25)" stroke-opacity="1" stroke-miterlimit="10" d="M 76.5 112.5 L 99.601562 112.5 "/>
<path fill="none" stroke-width="1" stroke-linecap="butt" stroke-linejoin="miter" stroke="rgb(0%25, 0%25, 0%25)" stroke-opacity="1" stroke-miterlimit="10" d="M 104.398438 112.5 L 127.5 112.5 "/>
<path fill="none" stroke-width="1" stroke-linecap="butt" stroke-linejoin="miter" stroke="rgb(0%25, 0%25, 0%25)" stroke-opacity="1" stroke-miterlimit="10" d="M 76.5 67.5 L 127.5 67.5 "/>
<path fill="none" stroke-width="1" stroke-linecap="butt" stroke-linejoin="miter" stroke="rgb(0%25, 0%25, 0%25)" stroke-opacity="1" stroke-miterlimit="10" d="M 127.5 22.5 L 127.5 22.5 "/>
<path fill="none" stroke-width="1" stroke-linecap="butt" stroke-linejoin="miter" stroke="rgb(0%25, 0%25, 0%25)" stroke-opacity="1" stroke-miterlimit="10" d="M 127.5 67.5 L 127.5 67.5 "/>
<path fill="none" stroke-width="1" stroke-linecap="butt" stroke-linejoin="miter" stroke="rgb(0%25, 0%25, 0%25)" stroke-opacity="1" stroke-miterlimit="10" d="M 127.5 112.5 L 127.5 112.5 "/>
</svg>
'/><p>Now we construct a 3-qubit quantum circuit to perform the following operations:</p><ol><li>Encoding the initial state with the encoding circuit.</li><li>Apply an logical X gate which consists of three X gates on the three qubits.</li><li>Decoding the state with the encoding circuit.</li><li>Apply an X gate to recover the initial state.</li></ol><pre><code class="language-julia hljs">qc = chain(qcen, put(3, 1=&gt;X),put(3,2=&gt;X),put(3,3=&gt;X), qcen&#39;, put(3, 3=&gt;X))
vizcircuit(qc)</code></pre><img src="5ac955ec.svg" alt="Example block output"/><p>This circuit should act trivially on the third qubit. We can transform the circuit to a tensor network to check the infidelity after the circuit.</p><pre><code class="language-julia hljs">tn = fidelity_tensornetwork(qc, QCInfo(data_qubits, 3))
optnet = optimize_code(tn, TreeSA(; ntrials=1, niters=3), OMEinsum.MergeVectors())
inf = 1-abs(contract(optnet)[1]/4)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">0.0</code></pre><h2 id="Coherent-Error-Simulation-2"><a class="docs-heading-anchor" href="#Coherent-Error-Simulation-2">Coherent Error Simulation</a><a class="docs-heading-anchor-permalink" href="#Coherent-Error-Simulation-2" title="Permalink"></a></h2><p>We add coherent error to the circuit by adding unitary error to every unitary gate. Here we suppose that for each unitary, the errored unitary is fixed to it, i.e., we apply the same errored X gate every time we want to apply an X gate. If you want to apply random errored unitary, you can call <a href="../../man/#TensorQEC.coherent_error_unitary-Union{Tuple{T}, Tuple{AbstractMatrix{T}, Real}} where T"><code>coherent_error_unitary</code></a> to generate the errored unitary ervey time you want to apply it.</p><p><a href="../../man/#TensorQEC.error_pairs-Tuple{T} where T&lt;:Real"><code>error_pairs</code></a> generates the error pairs for the gates to be replaced. Here we replace all the X gates and CNOT gates with the same errored X gate and CNOT gate.</p><pre><code class="language-julia hljs">pairs, vector = error_pairs(1e-5; gates = [X,ConstGate.CNOT])</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(Pair{A, YaoBlocks.GeneralMatrixBlock{2, ComplexF64, Matrix{ComplexF64}}} where A[X =&gt; <span class="sgr31">errored X</span>, CNOT =&gt; <span class="sgr31">errored CNOT</span>], [1.504378843719678e-10, 1.5615952975167602e-10])</code></pre><p>Then we can generate the error quantum circuit by <a href="../../man/#TensorQEC.error_quantum_circuit-Union{Tuple{T}, Tuple{YaoBlocks.ChainBlock, T}} where T&lt;:Real"><code>error_quantum_circuit</code></a>, which replaces the gates in the original circuit with the errored gates.</p><pre><code class="language-julia hljs">eqc = error_quantum_circuit(qc, pairs)
vizcircuit(eqc)</code></pre><img src="36978de7.svg" alt="Example block output"/><p>Finally, we can check the infidelity after the circuit with coherent error.</p><pre><code class="language-julia hljs">tn = fidelity_tensornetwork(eqc, QCInfo(data_qubits, 3))
optnet = optimize_code(tn, TreeSA(; ntrials=1, niters=3), OMEinsum.MergeVectors())
inf = 1-abs(contract(optnet)[1]/4)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">1.493975720912033e-9</code></pre><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../simulation/">« Measurement-Free QEC</a><a class="docs-footer-nextpage" href="../../man/">Manual »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.5.0 on <span class="colophon-date" title="Saturday 29 June 2024 19:58">Saturday 29 June 2024</span>. Using Julia version 1.10.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
