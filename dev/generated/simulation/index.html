<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Simulation · TensorQEC.jl</title><meta name="title" content="Simulation · TensorQEC.jl"/><meta property="og:title" content="Simulation · TensorQEC.jl"/><meta property="twitter:title" content="Simulation · TensorQEC.jl"/><meta name="description" content="Documentation for TensorQEC.jl."/><meta property="og:description" content="Documentation for TensorQEC.jl."/><meta property="twitter:description" content="Documentation for TensorQEC.jl."/><meta property="og:url" content="https://nzy1997.github.io/TensorQEC.jl/generated/simulation/"/><meta property="twitter:url" content="https://nzy1997.github.io/TensorQEC.jl/generated/simulation/"/><link rel="canonical" href="https://nzy1997.github.io/TensorQEC.jl/generated/simulation/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">TensorQEC.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Topics</span><ul><li><a class="tocitem" href="../inference/">Inference</a></li><li class="is-active"><a class="tocitem" href>Simulation</a><ul class="internal"><li><a class="tocitem" href="#Definition-of-Stabilizers-and-Encoding-Circuits"><span>Definition of Stabilizers and Encoding Circuits</span></a></li><li><a class="tocitem" href="#Syndrome-Extraction-and-Measurement-Free-Error-Correction"><span>Syndrome Extraction and Measurement-Free Error Correction</span></a></li><li><a class="tocitem" href="#Circuit-Simulation-with-Tensor-Networks"><span>Circuit Simulation with Tensor Networks</span></a></li><li><a class="tocitem" href="#Coherent-Error"><span>Coherent Error</span></a></li></ul></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Topics</a></li><li class="is-active"><a href>Simulation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Simulation</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/nzy1997/TensorQEC.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/nzy1997/TensorQEC.jl/blob/main/examples/simulation.jl" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Tensor-Network-Simulation"><a class="docs-heading-anchor" href="#Tensor-Network-Simulation">Tensor Network Simulation</a><a id="Tensor-Network-Simulation-1"></a><a class="docs-heading-anchor-permalink" href="#Tensor-Network-Simulation" title="Permalink"></a></h1><p>This example demonstrates how to use tensor network to simulate the error correction process. We use the <span>$[[7,1,3]]$</span> steane code and the measurement-free QEC<sup class="footnote-reference"><a id="citeref-Heußen" href="#footnote-Heußen">[Heußen]</a></sup> as an example. There are non-clifford gates in the quantum circuit, so we use tensor network to simulate the process.</p><h2 id="Definition-of-Stabilizers-and-Encoding-Circuits"><a class="docs-heading-anchor" href="#Definition-of-Stabilizers-and-Encoding-Circuits">Definition of Stabilizers and Encoding Circuits</a><a id="Definition-of-Stabilizers-and-Encoding-Circuits-1"></a><a class="docs-heading-anchor-permalink" href="#Definition-of-Stabilizers-and-Encoding-Circuits" title="Permalink"></a></h2><pre><code class="language-julia hljs">using TensorQEC, TensorQEC.Yao
using TensorQEC.OMEinsum
st = stabilizers(SteaneCode())</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">6-element Vector{PauliString{7}}:
 XIXIXIX
 IXXIIXX
 IIIXXXX
 ZIZIZIZ
 IZZIIZZ
 IIIZZZZ</code></pre><p>Generate the encoding circuits of the stabilizers.</p><pre><code class="language-julia hljs">qcen, data_qubits, code = encode_stabilizers(st)
vizcircuit(qcen)</code></pre><img src="666bb826.svg" alt="Example block output"/><h2 id="Syndrome-Extraction-and-Measurement-Free-Error-Correction"><a class="docs-heading-anchor" href="#Syndrome-Extraction-and-Measurement-Free-Error-Correction">Syndrome Extraction and Measurement-Free Error Correction</a><a id="Syndrome-Extraction-and-Measurement-Free-Error-Correction-1"></a><a class="docs-heading-anchor-permalink" href="#Syndrome-Extraction-and-Measurement-Free-Error-Correction" title="Permalink"></a></h2><p>First, we generate the steane measurement circuit and &#39;st_pos&#39; records the ancilla qubits that store the measurement results of the stabilizers.</p><pre><code class="language-julia hljs">qcm,st_pos, num_qubits = measure_circuit_steane(qcen,data_qubits[1],st,3)
vizcircuit(qcm)</code></pre><img src="5010a495.svg" alt="Example block output"/><p>Then we generate truth table for the error correction.</p><pre><code class="language-julia hljs">table = make_table(TensorQEC.stabilizers2bimatrix(st).matrix, 1)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Dict{Int64, Int64} with 14 entries:
  5  =&gt; 16
  56 =&gt; 8192
  16 =&gt; 256
  24 =&gt; 512
  8  =&gt; 128
  1  =&gt; 1
  32 =&gt; 1024
  6  =&gt; 32
  3  =&gt; 4
  7  =&gt; 64
  40 =&gt; 2048
  48 =&gt; 4096
  4  =&gt; 8
  2  =&gt; 2</code></pre><p>Now we can generate the measurement-free correction circuit by encoding the truth table on the quantum circuit directly.</p><pre><code class="language-julia hljs">qccr = correct_circuit(table, collect(st_pos), num_qubits, 6, 7)
vizcircuit(qccr)</code></pre><img src="ce710133.svg" alt="Example block output"/><h2 id="Circuit-Simulation-with-Tensor-Networks"><a class="docs-heading-anchor" href="#Circuit-Simulation-with-Tensor-Networks">Circuit Simulation with Tensor Networks</a><a id="Circuit-Simulation-with-Tensor-Networks-1"></a><a class="docs-heading-anchor-permalink" href="#Circuit-Simulation-with-Tensor-Networks" title="Permalink"></a></h2><p>We connect the encoding circuit, the measurement circuit, and the correction circuit to form a full circuit. And we apply a Y error on the third qubit after encoding.</p><pre><code class="language-julia hljs">qcf=chain(subroutine(num_qubits, qcen, 1:7),put(27,3=&gt;Y),qcm,qccr,subroutine(num_qubits, qcen&#39;, 1:7))
vizcircuit(qcf)</code></pre><img src="3fe7c92f.svg" alt="Example block output"/><p>Then we transform the circuit to a tensor network and optimize its contraction order.</p><pre><code class="language-julia hljs">tn = fidelity_tensornetwork(qcf, ConnectMap(data_qubits,setdiff(1:27, data_qubits), 27))
optnet = optimize_code(tn, TreeSA(), OMEinsum.MergeVectors())</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">TensorNetwork
Time complexity: 2^26.762601348732865
Space complexity: 2^21.0
Read-write complexity: 2^24.00581615057263</code></pre><p>Finally, we contract the tensor network to get the fidelity after error correction.</p><pre><code class="language-julia hljs">inf = 1-abs(contract(optnet)[1]/4)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">1.0</code></pre><h2 id="Coherent-Error"><a class="docs-heading-anchor" href="#Coherent-Error">Coherent Error</a><a id="Coherent-Error-1"></a><a class="docs-heading-anchor-permalink" href="#Coherent-Error" title="Permalink"></a></h2><p>Since coherent error is also non-clifford, we can use the same method to simulate the error correction process. First, we can generate the coherent error unitaries. &#39;Pair&#39; records the error pairs of the gates. &#39;vector&#39; records the error rates of the gates. We add coherent error to X, Y, Z, H, CZ, CNOT, CCZ, Toffoli gates by default. We customize our error gates to only single qubit gates.</p><pre><code class="language-julia hljs">pairs, vector = error_pairs(1e-5; gates = [X,Y,Z,H])</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(Pair{A, YaoBlocks.GeneralMatrixBlock{2, ComplexF64, Matrix{ComplexF64}}} where A[X =&gt; <span class="sgr31">errored X</span>, Y =&gt; <span class="sgr31">errored Y</span>, Z =&gt; <span class="sgr31">errored Z</span>, H =&gt; <span class="sgr31">errored H</span>], [5.1161852532288776e-11, 6.549050191040351e-11, 6.769984572940757e-11, 9.880540829954043e-12])</code></pre><p>Then we can generate the error quantum circuit.</p><pre><code class="language-julia hljs">qc = chain(subroutine(num_qubits, qcen, 1:7), qcm,qccr,subroutine(num_qubits, qcen&#39;, 1:7))
eqc = error_quantum_circuit(qc, pairs)
vizcircuit(eqc)</code></pre><img src="54c5c63d.svg" alt="Example block output"/><p>Finally, we can simulate the error correction process with the coherent error.</p><pre><code class="language-julia hljs">tn = fidelity_tensornetwork(eqc, ConnectMap(data_qubits,setdiff(1:27, data_qubits), 27))
optnet = optimize_code(tn, TreeSA(), OMEinsum.MergeVectors())
inf = 1-abs(contract(optnet)[1]/4)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">4.667322084372927e-11</code></pre><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p><section class="footnotes is-size-7"><ul><li class="footnote" id="footnote-Heußen"><a class="tag is-link" href="#citeref-Heußen">Heußen</a>Heußen, S., Locher, D. F., &amp; Müller, M. (2024). Measurement-Free Fault-Tolerant Quantum Error Correction in Near-Term Devices. PRX Quantum, 5(1), 010333. https://doi.org/10.1103/PRXQuantum.5.010333</li></ul></section></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../inference/">« Inference</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.5.0 on <span class="colophon-date" title="Wednesday 26 June 2024 09:09">Wednesday 26 June 2024</span>. Using Julia version 1.10.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
